<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Visualization | BioinfoHub</title>
  <meta name="description" content="A comprehensive collection of bioinformatics techniques." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Visualization | BioinfoHub" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A comprehensive collection of bioinformatics techniques." />
  <meta name="github-repo" content="rli012/rli012.github.io/BioinfoHub-pages" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Visualization | BioinfoHub" />
  
  <meta name="twitter:description" content="A comprehensive collection of bioinformatics techniques." />
  

<meta name="author" content="Ruidong Li" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html">
<link rel="next" href="GEO.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BioinfoHub</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and Motivation</a></li>
<li class="chapter" data-level="1" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>1</b> Visualization</a><ul>
<li class="chapter" data-level="1.1" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>1.1</b> Boxplot</a></li>
<li class="chapter" data-level="1.2" data-path="visualization.html"><a href="visualization.html#barplot"><i class="fa fa-check"></i><b>1.2</b> Barplot</a></li>
<li class="chapter" data-level="1.3" data-path="visualization.html"><a href="visualization.html#scatter-plot"><i class="fa fa-check"></i><b>1.3</b> Scatter plot</a></li>
<li class="chapter" data-level="1.4" data-path="visualization.html"><a href="visualization.html#volcano-plot"><i class="fa fa-check"></i><b>1.4</b> Volcano plot</a></li>
<li class="chapter" data-level="1.5" data-path="visualization.html"><a href="visualization.html#venn-diagram"><i class="fa fa-check"></i><b>1.5</b> Venn Diagram</a></li>
<li class="chapter" data-level="1.6" data-path="visualization.html"><a href="visualization.html#upset-plot"><i class="fa fa-check"></i><b>1.6</b> UpSet plot</a></li>
<li class="chapter" data-level="1.7" data-path="visualization.html"><a href="visualization.html#heatmap"><i class="fa fa-check"></i><b>1.7</b> Heatmap</a></li>
<li class="chapter" data-level="1.8" data-path="visualization.html"><a href="visualization.html#bubble-plot"><i class="fa fa-check"></i><b>1.8</b> Bubble plot</a></li>
<li class="chapter" data-level="1.9" data-path="visualization.html"><a href="visualization.html#radar-plot"><i class="fa fa-check"></i><b>1.9</b> Radar plot</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="GEO.html"><a href="GEO.html"><i class="fa fa-check"></i><b>2</b> Gene Expression Omnibus (GEO)</a></li>
<li class="chapter" data-level="3" data-path="Differential-Expression-Analysis.html"><a href="Differential-Expression-Analysis.html"><i class="fa fa-check"></i><b>3</b> Differential Expression Analysis</a></li>
<li class="chapter" data-level="4" data-path="Pathway-Enrichment-Analysis.html"><a href="Pathway-Enrichment-Analysis.html"><i class="fa fa-check"></i><b>4</b> Pathway Enrichment Anlaysis</a></li>
<li class="chapter" data-level="5" data-path="Single-Cell-Sequencing.html"><a href="Single-Cell-Sequencing.html"><i class="fa fa-check"></i><b>5</b> Single-cell Sequencing</a></li>
<li class="chapter" data-level="6" data-path="Databases.html"><a href="Databases.html"><i class="fa fa-check"></i><b>6</b> Databases</a><ul>
<li class="chapter" data-level="6.1" data-path="Databases.html"><a href="Databases.html#tcga"><i class="fa fa-check"></i><b>6.1</b> TCGA</a></li>
<li class="chapter" data-level="6.2" data-path="Databases.html"><a href="Databases.html#gtex"><i class="fa fa-check"></i><b>6.2</b> GTEx</a></li>
<li class="chapter" data-level="6.3" data-path="Databases.html"><a href="Databases.html#ccle"><i class="fa fa-check"></i><b>6.3</b> CCLE</a></li>
<li class="chapter" data-level="6.4" data-path="Databases.html"><a href="Databases.html#blueprint"><i class="fa fa-check"></i><b>6.4</b> Blueprint</a></li>
<li class="chapter" data-level="6.5" data-path="Databases.html"><a href="Databases.html#encode"><i class="fa fa-check"></i><b>6.5</b> Encode</a></li>
<li class="chapter" data-level="6.6" data-path="Databases.html"><a href="Databases.html#uniprot"><i class="fa fa-check"></i><b>6.6</b> Uniprot</a></li>
<li class="chapter" data-level="6.7" data-path="Databases.html"><a href="Databases.html#human-protein-atlas"><i class="fa fa-check"></i><b>6.7</b> Human Protein Atlas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BioinfoHub</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Visualization</h1>
<p><em>ggplot2</em> is a powerful package for data visualization in R. Most of the figures in this chapter are plotted using <em>ggplot2</em>. Other great packages such as <em>VennDiagram</em>, <em>UpSetR</em>, and <em>ComplexHeatmap</em> are used to generate special figures like Venn diagram, UpSet, and Heatmap, etc.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(ggsignif)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(scales) <span class="co"># dolor_format()</span></a></code></pre></div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">1.1</span> Boxplot</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">### Normal, 2 groups</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">dataForBoxPlot<span class="op">$</span>expr &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>DSG3</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>SampleType, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">pValue &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(dataForBoxPlot<span class="op">$</span>expr<span class="op">~</span>dataForBoxPlot<span class="op">$</span>group)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">anno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="fl">1.5</span>, <span class="dt">y =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">                   <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&#39;p = &#39;</span>, <span class="kw">formatC</span>(pValue, <span class="dt">format =</span> <span class="st">&quot;e&quot;</span>, <span class="dt">digits =</span> <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">                   <span class="dt">dataset=</span><span class="st">&#39;GSE79209&#39;</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>group),</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>, <span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>dataset, <span class="dt">nrow=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#darkblue</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="st">  </span><span class="co">#scale_fill_manual(values=c(&quot;#56B4E9&quot;, &quot;#E69F00&quot;)) +</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="st">  </span><span class="co">#geom_segment(data=df,aes(x = x1, y = y1, xend = x2, yend = y2)) +</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span>anno, <span class="kw">aes</span>(x, y, <span class="dt">label=</span>label, <span class="dt">group=</span><span class="ot">NULL</span>),</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">            <span class="dt">size=</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>,<span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">### Add stats manually, 3 groups</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#dataForBoxPlot &lt;- filter(dataForBoxPlot,</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#                         HistologyGrade %in% c(&#39;Normal&#39;,&#39;Mild dysplasia&#39;,&#39;Moderate dysplasia&#39;))</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">dataForBoxPlot &lt;-<span class="st"> </span>dataForBoxPlot[dataForBoxPlot<span class="op">$</span>HistologyGrade </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                                 <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Mild dysplasia&#39;</span>,<span class="st">&#39;Moderate dysplasia&#39;</span>),]</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">dataForBoxPlot<span class="op">$</span>expr &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>DSG3</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>HistologyGrade,</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                               <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Mild dysplasia&#39;</span>,<span class="st">&#39;Moderate dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">t &lt;-<span class="st"> </span><span class="kw">pairwise.wilcox.test</span>(dataForBoxPlot<span class="op">$</span>expr, dataForBoxPlot<span class="op">$</span>group,</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">                          <span class="dt">p.adjust.method =</span> <span class="st">&#39;none&#39;</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#t &lt;- pairwise.t.test(dataForBoxPlot$expr, dataForBoxPlot$group,</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#                     p.adjust.method = &#39;none&#39;)</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"></a>
<a class="sourceLine" id="cb3-23" data-line-number="23">pValue &lt;-<span class="st"> </span><span class="kw">c</span>(t<span class="op">$</span>p.value)[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">c</span>(t<span class="op">$</span>p.value))]</a>
<a class="sourceLine" id="cb3-24" data-line-number="24"></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>), <span class="co"># 1 vs. 2; 1 vs. 3; 2 vs. 3</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26">                 <span class="dt">x2=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">                 <span class="dt">y1=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="fl">5.2</span>, <span class="dv">6</span>,<span class="dv">6</span>,<span class="fl">6.2</span>, <span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.7</span>),</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">                 <span class="dt">y2=</span><span class="kw">c</span>(<span class="fl">5.2</span>,<span class="fl">5.2</span>,<span class="fl">5.2</span>, <span class="fl">6.2</span>,<span class="fl">6.2</span>,<span class="fl">6.2</span>, <span class="fl">5.7</span>,<span class="fl">5.7</span>,<span class="fl">5.7</span>))</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"></a>
<a class="sourceLine" id="cb3-31" data-line-number="31">anno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>),</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">                   <span class="dt">y=</span><span class="kw">c</span>(<span class="fl">5.3</span>,<span class="fl">6.3</span>,<span class="fl">5.9</span>),</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">                   <span class="dt">label=</span><span class="kw">as.character</span>(<span class="kw">symnum</span>(pValue, <span class="co">#corr = FALSE, na = FALSE,</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34">                                             <span class="dt">cutpoints =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb3-35" data-line-number="35">                                             <span class="dt">symbols =</span> <span class="kw">c</span>(<span class="st">&quot;***&quot;</span>,<span class="st">&#39;**&#39;</span>,<span class="st">&#39;*&#39;</span>,<span class="st">&#39;ns&#39;</span>))))</a>
<a class="sourceLine" id="cb3-36" data-line-number="36"></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#anno &lt;- data.frame(x=c(1.5,2,2.5),</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#                   y=c(8.55,8.95,8.8),</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#                   label=paste0(&#39;p = &#39;, formatC(pValue, format = &quot;e&quot;, digits = 2)))</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>group),</a>
<a class="sourceLine" id="cb3-44" data-line-number="44">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>, <span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>dataset, <span class="dt">nrow=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#darkblue</span></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#56B4E9&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>df,<span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y1, <span class="dt">xend =</span> x2, <span class="dt">yend =</span> y2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span>anno, <span class="kw">aes</span>(x, y, <span class="dt">label=</span>label, <span class="dt">group=</span><span class="ot">NULL</span>),</a>
<a class="sourceLine" id="cb3-52" data-line-number="52">            <span class="dt">size=</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>,<span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb3-55" data-line-number="55">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb3-56" data-line-number="56">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">### Add stats automatically, 3 groups</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">## ggsignif(), can provide self-defined annotations, otherwise perform wilcox test by default</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">filter</span>(dataForBoxPlot,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">                         HistologyGrade <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Mild dysplasia&#39;</span>,<span class="st">&#39;Moderate dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">dataForBoxPlot<span class="op">$</span>expr &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>DSG3</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>HistologyGrade,</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">                               <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Mild dysplasia&#39;</span>,<span class="st">&#39;Moderate dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb4-14" data-line-number="14">t &lt;-<span class="st"> </span><span class="kw">pairwise.wilcox.test</span>(dataForBoxPlot<span class="op">$</span>expr, dataForBoxPlot<span class="op">$</span>group,</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">                          <span class="dt">p.adjust.method =</span> <span class="st">&#39;none&#39;</span>)</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#t &lt;- pairwise.t.test(dataForBoxPlot$expr, dataForBoxPlot$group,</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#                     p.adjust.method = &#39;none&#39;)</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#t$p.value</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21">pValue &lt;-<span class="st"> </span><span class="kw">c</span>(t<span class="op">$</span>p.value)[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">c</span>(t<span class="op">$</span>p.value))]</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">wtq &lt;-<span class="st"> </span><span class="kw">levels</span>(dataForBoxPlot<span class="op">$</span>group)</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">lis &lt;-<span class="st"> </span><span class="kw">combn</span>(wtq,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">my_comparisons &lt;-<span class="st"> </span><span class="kw">tapply</span>(lis, <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(lis), <span class="dt">each=</span><span class="kw">nrow</span>(lis)), <span class="cf">function</span>(i) i)</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">my_comparisons &lt;-<span class="st"> </span>my_comparisons[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"></a>
<a class="sourceLine" id="cb4-28" data-line-number="28">my_annotations &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">symnum</span>(pValue, <span class="co">#corr = FALSE, na = FALSE,</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29">                                      <span class="dt">cutpoints =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">                                      <span class="dt">symbols =</span> <span class="kw">c</span>(<span class="st">&quot;***&quot;</span>,<span class="st">&#39;**&#39;</span>,<span class="st">&#39;*&#39;</span>,<span class="st">&#39;ns&#39;</span>)))</a>
<a class="sourceLine" id="cb4-31" data-line-number="31"></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#my_annotations &lt;- paste0(&#39;p = &#39;, formatC(pValue, format = &quot;e&quot;, digits = 2))</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>group),</a>
<a class="sourceLine" id="cb4-37" data-line-number="37">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>,<span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="st">  </span><span class="co">#geom_smooth(method=&#39;lm&#39;) +</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>dataset) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="st">  </span><span class="co">#geom_segment(data=df,aes(x = x1, y = y1, xend = x2, yend = y2)) +</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="st">  </span><span class="kw">geom_signif</span>(<span class="dt">annotations =</span> my_annotations, <span class="co"># optional</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45">              <span class="dt">comparisons =</span> my_comparisons,</a>
<a class="sourceLine" id="cb4-46" data-line-number="46">              <span class="dt">step_increase =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb4-47" data-line-number="47">              <span class="dt">vjust=</span>.<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb4-48" data-line-number="48">              <span class="dt">colour=</span><span class="st">&#39;gray20&#39;</span>,</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">              <span class="dt">tip_length=</span><span class="fl">0.015</span>) <span class="op">+</span><span class="st"> </span><span class="co"># 0</span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>,<span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb4-52" data-line-number="52">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-53" data-line-number="53">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">### Flip coord, with/without boarder</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># No boarder, single color</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">dataForBoxPlot<span class="op">$</span>expr &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>DSG3</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>HistologyGrade</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">exprMean &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">meanExpr=</span><span class="kw">mean</span>(expr))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>group, </a>
<a class="sourceLine" id="cb5-10" data-line-number="10">                               <span class="dt">levels=</span>exprMean<span class="op">$</span>group[<span class="kw">order</span>(exprMean<span class="op">$</span>meanExpr, <span class="dt">decreasing =</span> F)])</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&#39;#00AFBB&#39;</span>,<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">alpha=</span><span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>,<span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;Sample Type&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>, <span class="dt">color=</span><span class="st">&#39;grey20&#39;</span>),</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">        <span class="dt">axis.title.y =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb5-25" data-line-number="25">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">hjust=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">        <span class="dt">axis.line =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-4.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">dataForBoxPlot<span class="op">$</span>expr &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>DSG3</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span>dataForBoxPlot<span class="op">$</span>HistologyGrade</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">exprMean &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">meanExpr=</span><span class="kw">mean</span>(expr))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>group,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                               <span class="dt">levels=</span>exprMean<span class="op">$</span>group[<span class="kw">order</span>(dataForBoxPlot[<span class="kw">match</span>(exprMean<span class="op">$</span>group,                                                                    dataForBoxPlot<span class="op">$</span>group),]<span class="op">$</span>dataset,exprMean<span class="op">$</span>meanExpr)])</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>group),<span class="co">#size=0.5,</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>,<span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>, <span class="dt">width=</span><span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="st">  </span><span class="co">#facet_wrap(~study, nrow=3, scales=&#39;free&#39;) +</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="st">  </span><span class="co">#theme_set(theme_minimal()) #</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb6-28" data-line-number="28">        <span class="co">#panel.border = element_blank(),</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-5.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">### Comparison within each group</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr=</span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(dataForBoxPlot[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                             <span class="dt">group=</span><span class="kw">rep</span>(dataForBoxPlot<span class="op">$</span>SampleType,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                             <span class="dt">gene=</span><span class="kw">rep</span>(<span class="kw">colnames</span>(dataForBoxPlot)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dt">each=</span><span class="kw">nrow</span>(dataForBoxPlot)),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>group, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">dataForBoxPlot<span class="op">$</span>gene &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>gene, <span class="dt">levels=</span><span class="kw">unique</span>(dataForBoxPlot<span class="op">$</span>gene))</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#dataForBoxPlot &lt;- dataForBoxPlot[-which(is.na(dataForBoxPlot$expr)),]</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#dim(dataForBoxPlot)</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># NOT WORKING UNLESS plyr IS UNLOADED</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">pValue &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gene) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw">do</span>(<span class="dt">test =</span> <span class="kw">wilcox.test</span>(expr<span class="op">~</span>group, <span class="dt">data=</span>., <span class="dt">paired=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">  </span><span class="kw">summarise</span>(gene, <span class="dt">pval =</span> test<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">pValue &lt;-<span class="st"> </span>pValue<span class="op">$</span>pval</a>
<a class="sourceLine" id="cb7-21" data-line-number="21"></a>
<a class="sourceLine" id="cb7-22" data-line-number="22">my_annotations &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">symnum</span>(pValue, <span class="co">#corr = FALSE, na = FALSE,</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23">                                      <span class="dt">cutpoints =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">                                      <span class="dt">symbols =</span> <span class="kw">c</span>(<span class="st">&quot;***&quot;</span>,<span class="st">&#39;**&#39;</span>,<span class="st">&#39;*&#39;</span>,<span class="st">&#39;ns&#39;</span>)))</a>
<a class="sourceLine" id="cb7-25" data-line-number="25"></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#my_annotations &lt;- paste0(&#39;p = &#39;, formatC(pValue, format = &quot;e&quot;, digits = 2))</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#anno &lt;- data.frame(x=1:5,y=17.5,label=my_annotations)</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"></a>
<a class="sourceLine" id="cb7-29" data-line-number="29">exprMax &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gene) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">maxExpr=</span><span class="kw">max</span>(expr))</a>
<a class="sourceLine" id="cb7-30" data-line-number="30"></a>
<a class="sourceLine" id="cb7-31" data-line-number="31">anno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>exprMax<span class="op">$</span>gene,<span class="dt">y=</span>exprMax<span class="op">$</span>maxExpr<span class="op">+</span><span class="dv">1</span>,<span class="dt">label=</span>my_annotations,<span class="dt">gene=</span>exprMax<span class="op">$</span>gene)</a>
<a class="sourceLine" id="cb7-32" data-line-number="32">anno &lt;-<span class="st"> </span>anno[<span class="kw">which</span>(anno<span class="op">$</span>label<span class="op">!=</span><span class="st">&#39;ns&#39;</span>),]</a>
<a class="sourceLine" id="cb7-33" data-line-number="33"></a>
<a class="sourceLine" id="cb7-34" data-line-number="34">p &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="fl">0.58</span>)</a>
<a class="sourceLine" id="cb7-35" data-line-number="35"></a>
<a class="sourceLine" id="cb7-36" data-line-number="36">bxplt &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>gene, <span class="dt">y=</span>expr, <span class="dt">group =</span> <span class="kw">interaction</span>(group, gene)))</a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#fill=interaction(group,project))</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#stat_boxplot(geom =&#39;errorbar&#39;, width=0.5, position = position_dodge(width = 0.75))</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#stat_summary(geom =&#39;crossbar&#39;, width=0.5, color=&#39;white&#39;)</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"></a>
<a class="sourceLine" id="cb7-41" data-line-number="41">bxplt<span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">color=</span>group, <span class="dt">fill=</span>group),</a>
<a class="sourceLine" id="cb7-42" data-line-number="42">                   <span class="dt">outlier.shape =</span> <span class="dv">21</span>, <span class="dt">outlier.size =</span> <span class="dv">1</span>,<span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43">                   <span class="dt">outlier.fill =</span> <span class="ot">NA</span>, <span class="dt">alpha=</span><span class="dv">1</span>, <span class="dt">width=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb7-44" data-line-number="44">                   <span class="dt">position =</span> p) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;crossbar&quot;</span>, <span class="dt">width=</span><span class="fl">0.45</span>, <span class="dt">fatten=</span><span class="dv">0</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">position=</span>p,</a>
<a class="sourceLine" id="cb7-46" data-line-number="46">               <span class="dt">fun.data =</span> <span class="cf">function</span>(x){ <span class="kw">return</span>(<span class="kw">c</span>(<span class="dt">y=</span><span class="kw">median</span>(x), <span class="dt">ymin=</span><span class="kw">median</span>(x), <span class="dt">ymax=</span><span class="kw">median</span>(x))) }) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="st">  </span><span class="co">#scale_fill_npg(palette = &#39;nrc&#39;, alpha = 0.5)+</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="st">  </span><span class="co">#scale_fill_manual(values=c(&#39;limegreen&#39;, &#39;blue&#39;),</span></a>
<a class="sourceLine" id="cb7-49" data-line-number="49"><span class="st">  </span><span class="co">#                  labels=c(&#39;Normal&#39;, &#39;Dysplasia&#39;),</span></a>
<a class="sourceLine" id="cb7-50" data-line-number="50"><span class="st">  </span><span class="co">#                  name=&#39;Sample type&#39;) +</span></a>
<a class="sourceLine" id="cb7-51" data-line-number="51"><span class="st">  </span><span class="co">#geom_jitter(size=0.3)+</span></a>
<a class="sourceLine" id="cb7-52" data-line-number="52"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-53" data-line-number="53"><span class="st">  </span><span class="co">#ylim(-5,20) +</span></a>
<a class="sourceLine" id="cb7-54" data-line-number="54"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span>anno, <span class="kw">aes</span>(x, y, <span class="dt">label=</span>label, <span class="dt">group=</span><span class="ot">NULL</span>),</a>
<a class="sourceLine" id="cb7-55" data-line-number="55">            <span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-56" data-line-number="56"><span class="st">  </span><span class="co">#geom_signif(annotations = my_annotations,</span></a>
<a class="sourceLine" id="cb7-57" data-line-number="57"><span class="st">  </span><span class="co">#            y_position = rep(7.5,5),</span></a>
<a class="sourceLine" id="cb7-58" data-line-number="58"><span class="st">  </span><span class="co">#            xmin = c(1,2,3,4,5)-0.15,</span></a>
<a class="sourceLine" id="cb7-59" data-line-number="59"><span class="st">  </span><span class="co">#            xmax = c(1,2,3,4,5)+0.15,</span></a>
<a class="sourceLine" id="cb7-60" data-line-number="60"><span class="st">  </span><span class="co">#            #comparisons = my_comparisons,</span></a>
<a class="sourceLine" id="cb7-61" data-line-number="61"><span class="st">  </span><span class="co">#            step_increase = 0,</span></a>
<a class="sourceLine" id="cb7-62" data-line-number="62"><span class="st">  </span><span class="co">#            vjust=.2,</span></a>
<a class="sourceLine" id="cb7-63" data-line-number="63"><span class="st">  </span><span class="co">#            colour=&#39;gray20&#39;,</span></a>
<a class="sourceLine" id="cb7-64" data-line-number="64"><span class="st">  </span><span class="co">#            tip_length=0) + # 0</span></a>
<a class="sourceLine" id="cb7-65" data-line-number="65"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb7-66" data-line-number="66"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb7-67" data-line-number="67">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb7-68" data-line-number="68">        <span class="dt">legend.position =</span> <span class="st">&#39;right&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-69" data-line-number="69"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb7-70" data-line-number="70">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb7-71" data-line-number="71">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">hjust=</span><span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-72" data-line-number="72"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb7-73" data-line-number="73">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb7-74" data-line-number="74">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-75" data-line-number="75"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-6.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">### Facet_wrap()</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBoxPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">dataForBoxPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr=</span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(dataForBoxPlot[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                             <span class="dt">group=</span><span class="kw">rep</span>(dataForBoxPlot<span class="op">$</span>SampleType,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                             <span class="dt">gene=</span><span class="kw">rep</span>(<span class="kw">colnames</span>(dataForBoxPlot)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dt">each=</span><span class="kw">nrow</span>(dataForBoxPlot)),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">dataForBoxPlot<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>group, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;Normal&#39;</span>,<span class="st">&#39;Dysplasia&#39;</span>))</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">dataForBoxPlot<span class="op">$</span>gene &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBoxPlot<span class="op">$</span>gene, <span class="dt">levels=</span><span class="kw">unique</span>(dataForBoxPlot<span class="op">$</span>gene))</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#dataForBoxPlot &lt;- dataForBoxPlot[-which(is.na(dataForBoxPlot$expr)),]</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#dim(dataForBoxPlot)</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co"># NOT WORKING UNLESS plyr IS UNLOADED</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15">pValue &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gene) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="st">  </span><span class="kw">do</span>(<span class="dt">test =</span> <span class="kw">wilcox.test</span>(expr<span class="op">~</span>group, <span class="dt">data=</span>., <span class="dt">paired=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="st">  </span><span class="kw">summarise</span>(gene, <span class="dt">pval =</span> test<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb8-18" data-line-number="18"></a>
<a class="sourceLine" id="cb8-19" data-line-number="19">pValue &lt;-<span class="st"> </span>pValue<span class="op">$</span>pval</a>
<a class="sourceLine" id="cb8-20" data-line-number="20"></a>
<a class="sourceLine" id="cb8-21" data-line-number="21">my_annotations &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">symnum</span>(pValue, <span class="co">#corr = FALSE, na = FALSE,</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22">                                      <span class="dt">cutpoints =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">                                      <span class="dt">symbols =</span> <span class="kw">c</span>(<span class="st">&quot;***&quot;</span>,<span class="st">&#39;**&#39;</span>,<span class="st">&#39;*&#39;</span>,<span class="st">&#39;ns&#39;</span>)))</a>
<a class="sourceLine" id="cb8-24" data-line-number="24"></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#my_annotations &lt;- paste0(&#39;p = &#39;, formatC(pValue, format = &quot;e&quot;, digits = 2))</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#anno &lt;- data.frame(x=1:5,y=17.5,label=my_annotations)</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"></a>
<a class="sourceLine" id="cb8-28" data-line-number="28">exprMax &lt;-<span class="st"> </span>dataForBoxPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gene) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">maxExpr=</span><span class="kw">max</span>(expr))</a>
<a class="sourceLine" id="cb8-29" data-line-number="29"></a>
<a class="sourceLine" id="cb8-30" data-line-number="30">anno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="fl">1.5</span>,<span class="dt">y=</span><span class="fl">7.5</span>,<span class="dt">label=</span>my_annotations,<span class="dt">gene=</span>exprMax<span class="op">$</span>gene)</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">anno &lt;-<span class="st"> </span>anno[<span class="kw">which</span>(anno<span class="op">$</span>label<span class="op">!=</span><span class="st">&#39;ns&#39;</span>),]</a>
<a class="sourceLine" id="cb8-32" data-line-number="32"></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBoxPlot, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>group),</a>
<a class="sourceLine" id="cb8-35" data-line-number="35">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">outlier.size =</span> <span class="ot">NA</span>,<span class="co">#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36">               <span class="dt">outlier.fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="st">  </span><span class="co">#geom_boxplot(aes(color=group, fill=group),</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="st">  </span><span class="co">#             outlier.shape = 21, outlier.size = 1,#outlier.colour = &#39;black&#39;,</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="st">  </span><span class="co">#             outlier.fill = NA, alpha=1, width=0.5) +</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="st">  </span><span class="co">#stat_summary(geom = &quot;crossbar&quot;, width=0.45, fatten=0, color=&quot;white&quot;, position=p,</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="st">  </span><span class="co">#             fun.data = function(x){ return(c(y=median(x), ymin=median(x), ymax=median(x))) }) +</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gene, <span class="dt">nrow=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">color=</span><span class="st">&#39;darkblue&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;CPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="st">  </span><span class="co">#geom_segment(data=df,aes(x = x1, y = y1, xend = x2, yend = y2)) +</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span>anno, <span class="kw">aes</span>(x, y, <span class="dt">label=</span>label, <span class="dt">group=</span><span class="ot">NULL</span>),</a>
<a class="sourceLine" id="cb8-47" data-line-number="47">            <span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>,<span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb8-50" data-line-number="50">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb8-51" data-line-number="51">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb8-52" data-line-number="52">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-2-7.png" width="672" /></p>
</div>
<div id="barplot" class="section level2">
<h2><span class="header-section-number">1.2</span> Barplot</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">### Normal</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForBarPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr=</span><span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                             <span class="dt">sd =</span> <span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sd</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                             <span class="dt">cell=</span><span class="kw">rownames</span>(barData))</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">o &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)), <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">dataForBarPlot<span class="op">$</span>cell &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>cell, <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>cell[o])</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>cell, <span class="dt">y=</span>expr), <span class="dt">fill=</span><span class="st">&#39;black&#39;</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">8</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="st">  </span><span class="co">#geom_errorbar(aes(ymin=expr, ymax=expr+sd), width=.2, size=0.5, #expr-sd</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="st">  </span><span class="co">#              position=position_dodge(.9)) +</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (TPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="st">  </span><span class="co">#scale_fill_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb9-30" data-line-number="30">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb9-31" data-line-number="31">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb9-33" data-line-number="33">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-34" data-line-number="34">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-35" data-line-number="35">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-36" data-line-number="36">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">### Errorbar, axis transformation</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForBarPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr=</span><span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                             <span class="dt">sd =</span> <span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sd</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                             <span class="dt">cell=</span><span class="kw">rownames</span>(barData))</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">o &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)), <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">dataForBarPlot<span class="op">$</span>cell &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>cell, <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>cell[o])</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>cell, <span class="dt">y=</span>expr, <span class="dt">fill=</span>cell, <span class="dt">color=</span>cell)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>expr, <span class="dt">ymax=</span>expr<span class="op">+</span>sd), <span class="dt">width=</span>.<span class="dv">2</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="co">#expr-sd</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16">                <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (TPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&#39;sqrt&#39;</span>,</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="dv">50</span>,<span class="dv">250</span>,<span class="dv">750</span>),</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="dv">50</span>,<span class="dv">250</span>,<span class="dv">750</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="st">  </span><span class="co">#scale_fill_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-27" data-line-number="27">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb10-28" data-line-number="28">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb10-30" data-line-number="30">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb10-31" data-line-number="31">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb10-33" data-line-number="33">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-34" data-line-number="34">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-35" data-line-number="35">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb10-36" data-line-number="36">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">### errorbar, both side</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForBarPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">expr=</span><span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                             <span class="dt">sd =</span> <span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sd</span>(x, <span class="dt">na.rm=</span>T)),</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                             <span class="dt">cell=</span><span class="kw">rownames</span>(barData))</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">o &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="kw">apply</span>(barData, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">na.rm=</span>T)), <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">dataForBarPlot<span class="op">$</span>cell &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>cell, <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>cell[o])</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>cell, <span class="dt">y=</span>expr, <span class="dt">fill=</span>cell)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>expr<span class="op">-</span>sd, <span class="dt">ymax=</span>expr<span class="op">+</span>sd), <span class="dt">width=</span>.<span class="dv">2</span>, <span class="dt">size=</span><span class="fl">0.5</span>, <span class="co">#expr-sd</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">                <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Expression Level (TPM)&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="st">  </span><span class="co">#scale_fill_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb11-26" data-line-number="26">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb11-27" data-line-number="27">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb11-32" data-line-number="32">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb11-33" data-line-number="33">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb11-35" data-line-number="35">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># with negative values</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForBarPlot_Negative.rds&#39;</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">dataForBarPlot &lt;-<span class="st"> </span>barData <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Subtype) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">expr=</span><span class="kw">mean</span>(Exprs), <span class="dt">sd=</span><span class="kw">sd</span>(Exprs))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">dataForBarPlot</a></code></pre></div>
<pre><code>## # A tibble: 53 x 3
##    Subtype                                   expr    sd
##    &lt;chr&gt;                                    &lt;dbl&gt; &lt;dbl&gt;
##  1 Adipose - Subcutaneous                   3.03   1.29
##  2 Adipose - Visceral (Omentum)             4.00   1.75
##  3 Adrenal Gland                            2.53   1.17
##  4 Artery - Aorta                           3.53   1.42
##  5 Artery - Coronary                        3.46   1.57
##  6 Artery - Tibial                          2.48   1.27
##  7 Bladder                                  2.48   1.09
##  8 Brain - Amygdala                         0.909  1.80
##  9 Brain - Anterior cingulate cortex (BA24) 0.488  1.59
## 10 Brain - Caudate (basal ganglia)          1.08   1.65
## #  with 43 more rows</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot<span class="op">$</span>expr, <span class="dt">decreasing =</span> F)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">dataForBarPlot<span class="op">$</span>Subtype &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Subtype, <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>Subtype[o])</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co"># colors</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>Subtype, <span class="dt">y=</span>expr, <span class="dt">fill=</span>Subtype, <span class="dt">color=</span>Subtype)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span><span class="kw">ifelse</span>(expr<span class="op">&gt;</span><span class="dv">0</span>, expr, expr<span class="op">-</span>sd),</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">                    <span class="dt">ymax=</span><span class="kw">ifelse</span>(expr<span class="op">&gt;</span><span class="dv">0</span>, expr<span class="op">+</span>sd, expr)),</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">                <span class="dt">width=</span>.<span class="dv">5</span>, <span class="dt">size=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">                <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;mRNA Level (TPM)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="st">  </span><span class="co">#scale_fill_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb14-26" data-line-number="26">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb14-29" data-line-number="29">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb14-30" data-line-number="30">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb14-31" data-line-number="31">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">5</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-4-1.png" width="1152" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># black</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>Subtype, <span class="dt">y=</span>expr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span><span class="kw">ifelse</span>(expr<span class="op">&gt;</span><span class="dv">0</span>, expr, expr<span class="op">-</span>sd),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                    <span class="dt">ymax=</span><span class="kw">ifelse</span>(expr<span class="op">&gt;</span><span class="dv">0</span>, expr<span class="op">+</span>sd, expr)),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">                <span class="dt">width=</span>.<span class="dv">5</span>, <span class="dt">size=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">                <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;mRNA Level (TPM)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="st">  </span><span class="co">#scale_fill_manual(values = rep(&#39;dodgerblue&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb15-27" data-line-number="27">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">5</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-4-2.png" width="1152" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">###</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>Subtype, <span class="dt">y=</span>expr, <span class="dt">fill=</span>Subtype)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span>.<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>expr<span class="op">-</span>sd,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                    <span class="dt">ymax=</span>expr<span class="op">+</span>sd),</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                <span class="dt">width=</span>.<span class="dv">5</span>, <span class="dt">size=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">                <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;mRNA Level (TPM)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rep</span>(<span class="st">&#39;dodgerblue&#39;</span>,<span class="kw">nrow</span>(dataForBarPlot))) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="st">  </span><span class="co">#scale_color_manual(values = rep(&#39;black&#39;,nrow(dataForBarPlot))) +</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-18" data-line-number="18">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb16-19" data-line-number="19">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb16-21" data-line-number="21">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb16-22" data-line-number="22">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb16-24" data-line-number="24">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-25" data-line-number="25">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-26" data-line-number="26">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-27" data-line-number="27">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="dv">5</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-4-3.png" width="1152" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">### Multiple groups, Gene Ontology, GO</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_GO.rds&#39;</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span>dataForBarPlot[dataForBarPlot<span class="op">$</span>PValue<span class="op">&lt;</span><span class="fl">0.05</span>,]</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">dataForBarPlot<span class="op">$</span>Category &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Category, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;BP&#39;</span>,<span class="st">&#39;CC&#39;</span>,<span class="st">&#39;MF&#39;</span>))</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Term, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(PValue), <span class="dt">fill=</span>Category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span>dataForBarPlot<span class="op">$</span>Term) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="op">-</span><span class="kw">log10</span>(dataForBarPlot<span class="op">$</span>PValue))) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(P Value)&#39;</span>)) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip() +</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">  </span><span class="co">#scale_fill_hue(name=&#39;&#39;,breaks=kegg$Regulation,</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="st">  </span><span class="co">#               labels=kegg$Regulation) +</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="st">  </span><span class="co">#scale_fill_manual(values = c(&#39;orange&#39;,&#39;dodgerblue&#39;)) +</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&#39;darkblue&#39;</span>,<span class="st">&#39;darkgreen&#39;</span>,<span class="st">&#39;darkred&#39;</span>),</a>
<a class="sourceLine" id="cb17-16" data-line-number="16">                    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&#39;Biological Process&#39;</span>,<span class="st">&#39;Cellular Component&#39;</span>,<span class="st">&#39;Molecular Function&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="st">  </span><span class="co">#geom_text(aes(label=Count), vjust=-0.1, size=4) +</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb17-20" data-line-number="20">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb17-21" data-line-number="21">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb17-22" data-line-number="22">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb17-24" data-line-number="24">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-25" data-line-number="25">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb17-27" data-line-number="27">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">        <span class="dt">legend.position =</span> <span class="st">&#39;right&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">4.5</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-5-1.png" width="1152" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">### coord_flip(), KEGG</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_KEGG.rds&#39;</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Term, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(PValue),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                                        <span class="dt">fill=</span>Regulation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">rev</span>(dataForBarPlot<span class="op">$</span>Term)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="op">-</span><span class="kw">log10</span>(dataForBarPlot<span class="op">$</span>PValue))) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(P Value)&#39;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="st">  </span><span class="co">#scale_fill_hue(name=&#39;&#39;,breaks=kegg$Regulation,</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="st">  </span><span class="co">#               labels=kegg$Regulation) +</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="st">  </span><span class="co">#scale_fill_manual(values = c(&#39;orange&#39;,&#39;dodgerblue&#39;)) +</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>))<span class="op">+</span><span class="co">#,breaks=kegg$Reg) +</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="st">  </span><span class="co">#geom_text(aes(label=Count), hjust=1, size=4.5) +</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb18-22" data-line-number="22">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb18-25" data-line-number="25">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">### add counts</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Term, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(PValue),</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">                                        <span class="dt">fill=</span>Regulation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">rev</span>(dataForBarPlot<span class="op">$</span>Term)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="op">-</span><span class="kw">log10</span>(dataForBarPlot<span class="op">$</span>PValue))) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(P Value)&#39;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="st">  </span><span class="co">#scale_fill_hue(name=&#39;&#39;,breaks=kegg$Regulation,</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">  </span><span class="co">#               labels=kegg$Regulation) +</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="st">  </span><span class="co">#scale_fill_manual(values = c(&#39;orange&#39;,&#39;dodgerblue&#39;)) +</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&#39;chocolate&#39;</span>))<span class="op">+</span><span class="co">#,breaks=kegg$Reg) +</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>Count), <span class="dt">hjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb19-19" data-line-number="19">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb19-21" data-line-number="21">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-6-2.png" width="768" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">### Axis position</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Term, <span class="dt">y=</span><span class="op">-</span><span class="kw">log10</span>(PValue), <span class="dt">fill=</span><span class="st">&#39;darkred&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">rev</span>(dataForBarPlot<span class="op">$</span>Term),</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">                   <span class="dt">expand=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">position=</span><span class="st">&#39;right&#39;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">  </span><span class="co">#ylim(0, max(-log(keggForPlot$Benjamini,10))) +</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(P Value)&#39;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="st">  </span><span class="co">#scale_fill_hue(name=&#39;&#39;,breaks=kegg$Regulation,</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="st">  </span><span class="co">#               labels=kegg$Regulation) +</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;darkred&#39;</span>, <span class="st">&#39;dodgerblue&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="st">  </span><span class="co">#geom_text(aes(label=Count), hjust=1, size=4) +</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb20-17" data-line-number="17">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb20-18" data-line-number="18">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb20-19" data-line-number="19">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb20-21" data-line-number="21">        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">0.2</span>,<span class="st">&#39;cm&#39;</span>),</a>
<a class="sourceLine" id="cb20-22" data-line-number="22">        <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">        <span class="dt">axis.line.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb20-24" data-line-number="24">        <span class="dt">axis.title.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))<span class="op">+</span><span class="co">#,</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="st">  </span><span class="co">#axis.title.y = element_text(vjust = -2, hjust=1.1, size=12, angle = 0)) +</span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb20-27" data-line-number="27">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb20-28" data-line-number="28">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-6-3.png" width="768" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">### Back to back</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># normal</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForBarPlot_TCGA.rds&#39;</span>)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"></a>
<a class="sourceLine" id="cb21-7" data-line-number="7">barData &lt;-<span class="st"> </span>barData[barData<span class="op">$</span>Program<span class="op">==</span><span class="st">&#39;TCGA&#39;</span>,]</a>
<a class="sourceLine" id="cb21-8" data-line-number="8"></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Size=</span><span class="kw">c</span>(barData<span class="op">$</span>Seq, barData<span class="op">$</span>Exp),</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">                             <span class="dt">Project=</span><span class="kw">rep</span>(barData<span class="op">$</span>Project,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">                             <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Seq&#39;</span>,<span class="st">&#39;Exp&#39;</span>),<span class="kw">nrow</span>(barData)),</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"></a>
<a class="sourceLine" id="cb21-15" data-line-number="15">dataForBarPlot<span class="op">$</span>Size &lt;-<span class="st"> </span><span class="kw">ifelse</span>(dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>,dataForBarPlot<span class="op">$</span>Size, dataForBarPlot<span class="op">$</span>Size<span class="op">*-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16"></a>
<a class="sourceLine" id="cb21-17" data-line-number="17">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot<span class="op">$</span>Size[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>], <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb21-18" data-line-number="18"></a>
<a class="sourceLine" id="cb21-19" data-line-number="19">dataForBarPlot<span class="op">$</span>Project &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Project,</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">                                 <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>Project[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>][o])</a>
<a class="sourceLine" id="cb21-21" data-line-number="21"></a>
<a class="sourceLine" id="cb21-22" data-line-number="22"></a>
<a class="sourceLine" id="cb21-23" data-line-number="23"></a>
<a class="sourceLine" id="cb21-24" data-line-number="24"><span class="kw">ggplot</span>(dataForBarPlot,<span class="kw">aes</span>(<span class="dt">y =</span> Size, <span class="dt">x =</span> Project, <span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="co">#,position=position_dodge(0.58)</span></a>
<a class="sourceLine" id="cb21-26" data-line-number="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Number of Samples&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-27" data-line-number="27"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co">#scale_x_discrete(limits=rev(levels(dataForBarPlot$Tissue))) +</span></a>
<a class="sourceLine" id="cb21-28" data-line-number="28"><span class="st">  </span><span class="co">#facet_grid(Category ~ .) + #, scales = &quot;free&quot;</span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="st">  </span><span class="co">#ylim(0,30) +</span></a>
<a class="sourceLine" id="cb21-30" data-line-number="30"><span class="st">  </span><span class="co">#scale_fill_manual(values=fill) +</span></a>
<a class="sourceLine" id="cb21-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">500</span>), <span class="dt">labels =</span> <span class="kw">abs</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">500</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-32" data-line-number="32"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb21-33" data-line-number="33">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb21-34" data-line-number="34">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb21-35" data-line-number="35">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb21-36" data-line-number="36">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-37" data-line-number="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb21-38" data-line-number="38">        <span class="dt">axis.text.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb21-39" data-line-number="39">        <span class="dt">axis.title.y =</span><span class="kw">element_blank</span>(), <span class="co"># flip x, y</span></a>
<a class="sourceLine" id="cb21-40" data-line-number="40">        <span class="dt">axis.title.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb21-41" data-line-number="41">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb21-43" data-line-number="43">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb21-44" data-line-number="44">        <span class="dt">legend.position =</span> <span class="st">&#39;top&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-45" data-line-number="45"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-7-1.png" width="1152" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">### Side by side</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co"># single</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_TCGA.rds&#39;</span>)</a>
<a class="sourceLine" id="cb22-5" data-line-number="5"></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">barData &lt;-<span class="st"> </span>barData[barData<span class="op">$</span>Program<span class="op">==</span><span class="st">&#39;TCGA&#39;</span>,]</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"></a>
<a class="sourceLine" id="cb22-8" data-line-number="8">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Size=</span><span class="kw">c</span>(barData<span class="op">$</span>Seq, barData<span class="op">$</span>Exp),</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">                             <span class="dt">Project=</span><span class="kw">rep</span>(barData<span class="op">$</span>Project,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">                             <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Seq&#39;</span>,<span class="st">&#39;Exp&#39;</span>),<span class="dt">each=</span><span class="kw">nrow</span>(barData)),</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb22-12" data-line-number="12"></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="co">#dataForBarPlot$Size &lt;- ifelse(dataForBarPlot$Type==&#39;Seq&#39;,dataForBarPlot$Size, dataForBarPlot$Size*-1)</span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"></a>
<a class="sourceLine" id="cb22-15" data-line-number="15">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot<span class="op">$</span>Size[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>], <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb22-16" data-line-number="16"></a>
<a class="sourceLine" id="cb22-17" data-line-number="17">dataForBarPlot<span class="op">$</span>Project &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Project,</a>
<a class="sourceLine" id="cb22-18" data-line-number="18">                                 <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>Project[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>][o])</a>
<a class="sourceLine" id="cb22-19" data-line-number="19"></a>
<a class="sourceLine" id="cb22-20" data-line-number="20"><span class="kw">ggplot</span>(dataForBarPlot, <span class="kw">aes</span>(<span class="dt">y =</span> Size, <span class="dt">x =</span> Project, <span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span><span class="fl">0.8</span>, <span class="dt">position=</span><span class="st">&#39;dodge&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-22" data-line-number="22"><span class="st">  </span><span class="co">#geom_text(aes(y = pos, x = pathway, label = paste0(percentage, &quot;%&quot;)),</span></a>
<a class="sourceLine" id="cb22-23" data-line-number="23"><span class="st">  </span><span class="co">#           data = dataForPlot) +</span></a>
<a class="sourceLine" id="cb22-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Number of Samples&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-25" data-line-number="25"><span class="st">  </span><span class="co">#facet_grid(Category ~ .) + #, scales = &quot;free&quot;</span></a>
<a class="sourceLine" id="cb22-26" data-line-number="26"><span class="st">  </span><span class="co">#ylim(0,30) +</span></a>
<a class="sourceLine" id="cb22-27" data-line-number="27"><span class="st">  </span><span class="co">#scale_fill_manual(values=fill) +</span></a>
<a class="sourceLine" id="cb22-28" data-line-number="28"><span class="st">  </span><span class="co">#scale_y_continuous(labels = dollar_format(suffix = &quot;%&quot;, prefix = &quot;&quot;)) +</span></a>
<a class="sourceLine" id="cb22-29" data-line-number="29"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb22-30" data-line-number="30">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb22-31" data-line-number="31">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb22-32" data-line-number="32">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb22-33" data-line-number="33">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb22-35" data-line-number="35">        <span class="dt">axis.text.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb22-36" data-line-number="36">        <span class="dt">axis.title.x =</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb22-37" data-line-number="37">        <span class="dt">axis.title.y =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb22-38" data-line-number="38">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-39" data-line-number="39"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb22-40" data-line-number="40">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb22-41" data-line-number="41">        <span class="dt">legend.position =</span> <span class="st">&#39;top&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-8-1.png" width="1152" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># side by side, multiple</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_TCGA.rds&#39;</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Size=</span><span class="kw">c</span>(barData<span class="op">$</span>Seq, barData<span class="op">$</span>Exp),</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">                             <span class="dt">Project=</span><span class="kw">rep</span>(barData<span class="op">$</span>Project,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">                             <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Seq&#39;</span>,<span class="st">&#39;Exp&#39;</span>),<span class="dt">each=</span><span class="kw">nrow</span>(barData)),</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">                             <span class="dt">Program=</span><span class="kw">rep</span>(barData<span class="op">$</span>Program,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>,]<span class="op">$</span>Program,</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">           dataForBarPlot[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>,]<span class="op">$</span>Size,</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">           <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb23-13" data-line-number="13"></a>
<a class="sourceLine" id="cb23-14" data-line-number="14">dataForBarPlot<span class="op">$</span>Project &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Project, </a>
<a class="sourceLine" id="cb23-15" data-line-number="15">                                 <span class="dt">levels =</span> dataForBarPlot[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>,]<span class="op">$</span>Project[o])</a>
<a class="sourceLine" id="cb23-16" data-line-number="16"></a>
<a class="sourceLine" id="cb23-17" data-line-number="17">dataForBarPlot<span class="op">$</span>Program &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Program, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;TCGA&#39;</span>,<span class="st">&#39;TARGET&#39;</span>))</a>
<a class="sourceLine" id="cb23-18" data-line-number="18"></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="kw">ggplot</span>(dataForBarPlot, <span class="kw">aes</span>(<span class="dt">y =</span> Size, <span class="dt">x =</span> Project, <span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span><span class="fl">0.8</span>, <span class="dt">position=</span><span class="st">&#39;dodge&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="st">  </span><span class="co">#geom_text(aes(y = pos, x = pathway, label = paste0(percentage, &quot;%&quot;)),</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="st">  </span><span class="co">#           data = dataForPlot) +</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Number of Samples&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Program, <span class="dt">scales=</span><span class="st">&#39;free&#39;</span>, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="co">#, scales = &quot;free&quot;</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="st">  </span><span class="co">#ylim(0,80) +</span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="st">  </span><span class="co">#scale_fill_manual(values=fill) +</span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="st">  </span><span class="co">#scale_y_continuous(labels = dollar_format(suffix = &quot;%&quot;, prefix = &quot;&quot;)) +</span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb23-30" data-line-number="30">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb23-31" data-line-number="31">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb23-32" data-line-number="32">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb23-33" data-line-number="33">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb23-35" data-line-number="35">        <span class="dt">axis.text.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb23-36" data-line-number="36">        <span class="dt">axis.title.x =</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb23-37" data-line-number="37">        <span class="dt">axis.title.y =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb23-38" data-line-number="38">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-39" data-line-number="39"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb23-40" data-line-number="40">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb23-41" data-line-number="41">        <span class="dt">legend.position =</span> <span class="st">&#39;top&#39;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.5</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-8-2.png" width="1152" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># multiple</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_PDX.rds&#39;</span>)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">dataForBarPlot &lt;-<span class="st"> </span>dataForBarPlot[<span class="kw">with</span>(dataForBarPlot, <span class="kw">order</span>(CANCER.TYPE, LOG2.FPKM.)),]</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">dataForBarPlot<span class="op">$</span>PDX.MODEL &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>PDX.MODEL, <span class="dt">levels =</span> dataForBarPlot<span class="op">$</span>PDX.MODEL)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6"></a>
<a class="sourceLine" id="cb24-7" data-line-number="7">idx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dataForBarPlot<span class="op">$</span>CANCER.TYPE) <span class="op">%in%</span><span class="st"> </span><span class="kw">which</span>(<span class="kw">duplicated</span>(dataForBarPlot<span class="op">$</span>CANCER.TYPE)))</a>
<a class="sourceLine" id="cb24-8" data-line-number="8"></a>
<a class="sourceLine" id="cb24-9" data-line-number="9">colors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;orange&#39;</span>,<span class="st">&#39;yellow&#39;</span>,<span class="st">&#39;springgreen&#39;</span>,<span class="st">&#39;royalblue&#39;</span>,<span class="st">&#39;cyan&#39;</span>,<span class="st">&#39;purple&#39;</span>,<span class="st">&#39;pink&#39;</span>,</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">           <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;chocolate&#39;</span>,<span class="st">&#39;goldenrod&#39;</span>,<span class="st">&#39;yellowgreen&#39;</span>,<span class="st">&#39;dodgerblue&#39;</span>,<span class="st">&#39;turquoise&#39;</span>,<span class="st">&#39;mediumorchid&#39;</span>,<span class="st">&#39;hotpink&#39;</span>,</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">           <span class="st">&#39;brown&#39;</span>,<span class="st">&#39;coral&#39;</span>,<span class="st">&#39;khaki&#39;</span>,<span class="st">&#39;limegreen&#39;</span>,<span class="st">&#39;skyblue&#39;</span>,<span class="st">&#39;aquamarine&#39;</span>,<span class="st">&#39;magenta&#39;</span>,</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">           <span class="st">&#39;tan&#39;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;seagreen&#39;</span>,<span class="st">&#39;violet&#39;</span>,<span class="st">&#39;maroon&#39;</span>,<span class="st">&#39;peru&#39;</span>)</a>
<a class="sourceLine" id="cb24-13" data-line-number="13"></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="kw">ggplot</span>(<span class="dt">data=</span>dataForBarPlot, <span class="kw">aes</span>(<span class="dt">x=</span>PDX.MODEL, <span class="dt">y=</span>LOG2.FPKM., <span class="dt">fill=</span>CANCER.TYPE, <span class="dt">color=</span>CANCER.TYPE)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">width=</span><span class="fl">0.01</span>) <span class="op">+</span><span class="st"> </span><span class="co">#coord_flip()</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="st">  </span><span class="co">#geom_errorbar(aes(ymin=expr, ymax=expr+sd), width=.2, size=0.5, #expr-sd</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="st">  </span><span class="co">#              position=position_dodge(.9)) +</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">&#39;Gene Expression (Log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;FPKM)&#39;</span>))<span class="op">+</span><span class="co">#, title=&#39;FPR1 Expresion (Microarray)&#39;) +</span></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">breaks =</span> dataForBarPlot<span class="op">$</span>PDX.MODEL[idx]) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> colors) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> colors) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="st">  </span><span class="co">#scale_y_continuous(trans = &#39;sqrt&#39;,</span></a>
<a class="sourceLine" id="cb24-24" data-line-number="24"><span class="st">  </span><span class="co">#                   breaks = c(0,2.5,50,250,750),</span></a>
<a class="sourceLine" id="cb24-25" data-line-number="25"><span class="st">  </span><span class="co">#                   labels = c(0,2.5,50,250,750)) +</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26"><span class="st">  </span><span class="co">#scale_y_sqrt() +</span></a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="st">  </span><span class="co">#scale_y_continuous(trans=&#39;log2&#39;) +</span></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">6</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb24-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-30" data-line-number="30">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb24-31" data-line-number="31">        <span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-32" data-line-number="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb24-33" data-line-number="33">        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-34" data-line-number="34">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-35" data-line-number="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb24-36" data-line-number="36">        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-37" data-line-number="37">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-38" data-line-number="38">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-39" data-line-number="39">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-40" data-line-number="40"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-9-1.png" width="1152" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">### Stacked</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co"># single</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_TCGA.rds&#39;</span>)</a>
<a class="sourceLine" id="cb25-7" data-line-number="7"></a>
<a class="sourceLine" id="cb25-8" data-line-number="8">barData &lt;-<span class="st"> </span>barData[barData<span class="op">$</span>Program<span class="op">==</span><span class="st">&#39;TCGA&#39;</span>,]</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Size=</span><span class="kw">c</span>(barData<span class="op">$</span>Seq, barData<span class="op">$</span>Exp),</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">                             <span class="dt">Project=</span><span class="kw">rep</span>(barData<span class="op">$</span>Project,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">                             <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Seq&#39;</span>,<span class="st">&#39;Exp&#39;</span>),<span class="dt">each=</span><span class="kw">nrow</span>(barData)),</a>
<a class="sourceLine" id="cb25-13" data-line-number="13">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb25-14" data-line-number="14"></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#dataForBarPlot$Size &lt;- ifelse(dataForBarPlot$Type==&#39;Seq&#39;,dataForBarPlot$Size, dataForBarPlot$Size*-1)</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"></a>
<a class="sourceLine" id="cb25-17" data-line-number="17">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot<span class="op">$</span>Size[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>], <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb25-18" data-line-number="18"></a>
<a class="sourceLine" id="cb25-19" data-line-number="19">dataForBarPlot<span class="op">$</span>Project &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Project,</a>
<a class="sourceLine" id="cb25-20" data-line-number="20">                                 <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>Project[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>][o])</a>
<a class="sourceLine" id="cb25-21" data-line-number="21"></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="kw">ggplot</span>(dataForBarPlot, <span class="kw">aes</span>(<span class="dt">y =</span> Size, <span class="dt">x =</span> Project, <span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span><span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="st">  </span><span class="co">#geom_text(aes(y = pos, x = pathway, label = paste0(percentage, &quot;%&quot;)),</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="st">  </span><span class="co">#           data = dataForPlot) +</span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Number of Samples&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-27" data-line-number="27"><span class="st">  </span><span class="co">#facet_grid(Category ~ .) + #, scales = &quot;free&quot;</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28"><span class="st">  </span><span class="co">#ylim(0,60) +</span></a>
<a class="sourceLine" id="cb25-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#4285F4&quot;</span>, <span class="st">&quot;#FBBC05&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="st">  </span><span class="co">#scale_fill_manual(values=c(&quot;#56B4E9&quot;, &quot;#E69F00&quot;)) +</span></a>
<a class="sourceLine" id="cb25-31" data-line-number="31"><span class="st">  </span><span class="co">#scale_y_continuous(labels = dollar_format(suffix = &quot;%&quot;, prefix = &quot;&quot;)) +</span></a>
<a class="sourceLine" id="cb25-32" data-line-number="32"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb25-33" data-line-number="33">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-34" data-line-number="34">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-35" data-line-number="35">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb25-36" data-line-number="36">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-37" data-line-number="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb25-38" data-line-number="38">        <span class="dt">axis.text.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb25-39" data-line-number="39">        <span class="dt">axis.title.x =</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-40" data-line-number="40">        <span class="dt">axis.title.y =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb25-41" data-line-number="41">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb25-43" data-line-number="43">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb25-44" data-line-number="44">        <span class="dt">legend.position =</span> <span class="st">&#39;top&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-45" data-line-number="45"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-10-1.png" width="1152" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Percentage label</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">barData &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&#39;data/dataForBarPlot_TCGA.rds&#39;</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"></a>
<a class="sourceLine" id="cb26-4" data-line-number="4">barData &lt;-<span class="st"> </span>barData[barData<span class="op">$</span>Program<span class="op">==</span><span class="st">&#39;TCGA&#39;</span>,]</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"></a>
<a class="sourceLine" id="cb26-6" data-line-number="6">barData<span class="op">$</span>ExpPercent &lt;-<span class="st"> </span><span class="kw">round</span>(barData<span class="op">$</span>Exp<span class="op">/</span>(barData<span class="op">$</span>Exp<span class="op">+</span>barData<span class="op">$</span>Seq),<span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">barData<span class="op">$</span>SeqPercent &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">-</span><span class="st"> </span>barData<span class="op">$</span>ExpPercent</a>
<a class="sourceLine" id="cb26-8" data-line-number="8"></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">dataForBarPlot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Percent=</span><span class="kw">c</span>(barData<span class="op">$</span>SeqPercent, barData<span class="op">$</span>ExpPercent),</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">                             <span class="dt">Project=</span><span class="kw">rep</span>(barData<span class="op">$</span>Project,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb26-11" data-line-number="11">                             <span class="dt">Type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Seq&#39;</span>,<span class="st">&#39;Exp&#39;</span>),<span class="dt">each=</span><span class="kw">nrow</span>(barData)),</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">                             <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb26-13" data-line-number="13"></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">pos &lt;-<span class="st"> </span>dataForBarPlot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Project) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">pos=</span><span class="kw">cumsum</span>(Percent)<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Percent)</a>
<a class="sourceLine" id="cb26-16" data-line-number="16"></a>
<a class="sourceLine" id="cb26-17" data-line-number="17">dataForBarPlot<span class="op">$</span>Pos &lt;-<span class="st"> </span>pos<span class="op">$</span>pos</a>
<a class="sourceLine" id="cb26-18" data-line-number="18"></a>
<a class="sourceLine" id="cb26-19" data-line-number="19">o &lt;-<span class="st"> </span><span class="kw">order</span>(dataForBarPlot<span class="op">$</span>Percent[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>], <span class="dt">decreasing =</span> T)</a>
<a class="sourceLine" id="cb26-20" data-line-number="20"></a>
<a class="sourceLine" id="cb26-21" data-line-number="21">dataForBarPlot<span class="op">$</span>Project &lt;-<span class="st"> </span><span class="kw">factor</span>(dataForBarPlot<span class="op">$</span>Project,</a>
<a class="sourceLine" id="cb26-22" data-line-number="22">                                 <span class="dt">levels=</span>dataForBarPlot<span class="op">$</span>Project[dataForBarPlot<span class="op">$</span>Type<span class="op">==</span><span class="st">&#39;Seq&#39;</span>][o])</a>
<a class="sourceLine" id="cb26-23" data-line-number="23"></a>
<a class="sourceLine" id="cb26-24" data-line-number="24">fill &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#40b8d0&quot;</span>, <span class="st">&quot;#b2d183&quot;</span>)</a>
<a class="sourceLine" id="cb26-25" data-line-number="25"><span class="co">#fill &lt;- c(&quot;orange&quot;, &quot;dodgerblue&quot;)</span></a>
<a class="sourceLine" id="cb26-26" data-line-number="26"></a>
<a class="sourceLine" id="cb26-27" data-line-number="27"><span class="kw">ggplot</span>(dataForBarPlot,</a>
<a class="sourceLine" id="cb26-28" data-line-number="28">       <span class="kw">aes</span>(<span class="dt">y =</span> Percent, <span class="dt">x =</span> Project, <span class="dt">fill =</span> Type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> dataForBarPlot,</a>
<a class="sourceLine" id="cb26-31" data-line-number="31">            <span class="kw">aes</span>(<span class="dt">y =</span> Pos, <span class="dt">x =</span> Project, <span class="dt">label =</span> <span class="kw">paste0</span>(Percent, <span class="st">&quot;%&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-32" data-line-number="32"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Percentage&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-33" data-line-number="33"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>fill) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-34" data-line-number="34"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> <span class="kw">dollar_format</span>(<span class="dt">suffix =</span> <span class="st">&quot;%&quot;</span>, <span class="dt">prefix =</span> <span class="st">&quot;&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-35" data-line-number="35"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb26-36" data-line-number="36">                   <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-37" data-line-number="37">                   <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-38" data-line-number="38">                   <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;white&#39;</span>),</a>
<a class="sourceLine" id="cb26-39" data-line-number="39">                   <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-40" data-line-number="40"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb26-41" data-line-number="41">        <span class="dt">axis.text.x =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb26-42" data-line-number="42">        <span class="dt">axis.title.x =</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-43" data-line-number="43">        <span class="dt">axis.title.y =</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-44" data-line-number="44"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb26-45" data-line-number="45">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-46" data-line-number="46">        <span class="dt">legend.position =</span> <span class="st">&#39;top&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-47" data-line-number="47"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-10-2.png" width="1152" /></p>
</div>
<div id="scatter-plot" class="section level2">
<h2><span class="header-section-number">1.3</span> Scatter plot</h2>
</div>
<div id="volcano-plot" class="section level2">
<h2><span class="header-section-number">1.4</span> Volcano plot</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">dataForVolcanoPlot &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file=</span><span class="st">&#39;data/dataForVolcanoPlot.rds&#39;</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="kw">head</span>(dataForVolcanoPlot)</a></code></pre></div>
<pre><code>##                      logFC  AveExpr         t      P.Value    adj.P.Val
## ENSG00000198198 -0.3685814 5.808755 -5.771041 1.617440e-07 0.0008963109
## ENSG00000188873  0.4789469 1.874537  5.717270 2.018297e-07 0.0008963109
## ENSG00000167978 -0.4744851 9.342415 -5.693374 2.226480e-07 0.0008963109
## ENSG00000240053 -0.7492838 1.665196 -5.674617 2.404580e-07 0.0008963109
## ENSG00000122965 -0.3832448 5.268089 -5.534147 4.266422e-07 0.0008963109
## ENSG00000235194 -0.4427459 4.229871 -5.509960 4.706653e-07 0.0008963109
##                        B   Symbol              Biotype
## ENSG00000198198 7.126766     SZT2       protein_coding
## ENSG00000188873 6.557968 RPL10AP2 processed_pseudogene
## ENSG00000167978 6.832038    SRRM2       protein_coding
## ENSG00000240053 6.337691   LY6G5B       protein_coding
## ENSG00000122965 6.208100    RBM19       protein_coding
## ENSG00000235194 6.134079  PPP1R3E       protein_coding</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">logFcThreshold &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">adjPvalThreshold &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">dataForVolcanoPlot<span class="op">$</span>Significance[<span class="kw">with</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb29-5" data-line-number="5">                                     logFC <span class="op">&lt;</span><span class="st"> </span>logFcThreshold <span class="op">|</span><span class="st"> </span>adj.P.Val <span class="op">&gt;</span><span class="st"> </span>adjPvalThreshold)] &lt;-<span class="st"> &#39;NS&#39;</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6">dataForVolcanoPlot<span class="op">$</span>Significance[<span class="kw">with</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb29-7" data-line-number="7">                                     logFC <span class="op">&gt;=</span><span class="st"> </span>logFcThreshold <span class="op">&amp;</span><span class="st"> </span>adj.P.Val <span class="op">&lt;=</span><span class="st"> </span>adjPvalThreshold)] &lt;-<span class="st"> &#39;UP&#39;</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8">dataForVolcanoPlot<span class="op">$</span>Significance[<span class="kw">with</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb29-9" data-line-number="9">                                     logFC <span class="op">&lt;=</span><span class="st"> </span><span class="op">-</span>logFcThreshold <span class="op">&amp;</span><span class="st"> </span>adj.P.Val <span class="op">&lt;=</span><span class="st"> </span>adjPvalThreshold)] &lt;-<span class="st"> &#39;DOWN&#39;</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="kw">ggplot</span>(dataForVolcanoPlot, <span class="kw">aes</span>(<span class="dt">x =</span> logFC, <span class="dt">y =</span> <span class="op">-</span><span class="kw">log10</span>(adj.P.Val))) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="st">  </span><span class="co">#xlim(-7.5,7.5)</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="kw">expression</span>(<span class="st">&#39;log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;(Fold Change)&#39;</span>), </a>
<a class="sourceLine" id="cb29-14" data-line-number="14">       <span class="dt">y=</span>(<span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(FDR)&#39;</span>)), </a>
<a class="sourceLine" id="cb29-15" data-line-number="15">       <span class="dt">title=</span><span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Significance), <span class="dt">alpha=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="op">-</span>logFcThreshold, logFcThreshold),</a>
<a class="sourceLine" id="cb29-18" data-line-number="18">             <span class="dt">color=</span><span class="st">&#39;darkgreen&#39;</span>, <span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="op">-</span><span class="kw">log10</span>(adjPvalThreshold), </a>
<a class="sourceLine" id="cb29-20" data-line-number="20">             <span class="dt">color=</span><span class="st">&#39;darkgreen&#39;</span>,<span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb29-21" data-line-number="21"><span class="st">  </span><span class="co">#scale_x_continuous(breaks=c(-4,-2,0,2,4,6,8,10)) +</span></a>
<a class="sourceLine" id="cb29-22" data-line-number="22"><span class="st">  </span><span class="co">#scale_y_continuous(expand = c(0.3, 0)) +</span></a>
<a class="sourceLine" id="cb29-23" data-line-number="23"><span class="st">  </span><span class="co">#scale_color_manual(values = c(&#39;#4285F4&#39;,&quot;gray&quot;, &#39;#FBBC05&#39;)) +</span></a>
<a class="sourceLine" id="cb29-24" data-line-number="24"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;green3&#39;</span>,<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-25" data-line-number="25"><span class="st">  </span><span class="co">#facet_wrap(~Comparison, ncol = 2) +</span></a>
<a class="sourceLine" id="cb29-26" data-line-number="26"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb29-27" data-line-number="27">                                adj.P.Val <span class="op">&lt;</span><span class="st"> </span>adjPvalThreshold <span class="op">&amp;</span><span class="st"> </span>logFC <span class="op">&gt;</span><span class="st"> </span><span class="kw">log2</span>(<span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb29-28" data-line-number="28">                  <span class="dt">segment.alpha =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">label =</span> Symbol), </a>
<a class="sourceLine" id="cb29-29" data-line-number="29">                  <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">color=</span><span class="st">&#39;red&#39;</span>, <span class="dt">segment.color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb29-31" data-line-number="31">                                adj.P.Val <span class="op">&lt;</span><span class="st"> </span>adjPvalThreshold <span class="op">&amp;</span><span class="st"> </span>logFC <span class="op">&lt;</span><span class="st"> </span><span class="kw">log2</span>(<span class="dv">2</span>)<span class="op">*-</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb29-32" data-line-number="32">                  <span class="dt">segment.alpha =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">label =</span> Symbol), </a>
<a class="sourceLine" id="cb29-33" data-line-number="33">                  <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">color=</span><span class="st">&#39;green3&#39;</span>, <span class="dt">segment.color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-35" data-line-number="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb29-36" data-line-number="36">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb29-37" data-line-number="37">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-38" data-line-number="38"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span>  <span class="kw">margin</span>(<span class="dt">t =</span> <span class="fl">0.25</span>, <span class="dt">r =</span> <span class="fl">0.25</span>, <span class="dt">b =</span> <span class="fl">0.25</span>, <span class="dt">l =</span> <span class="fl">0.25</span>, <span class="dt">unit =</span> <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">ggplot</span>(dataForVolcanoPlot, <span class="kw">aes</span>(<span class="dt">x =</span> logFC, <span class="dt">y =</span> <span class="op">-</span><span class="kw">log10</span>(adj.P.Val))) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="co">#xlim(-7.5,7.5)</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="kw">expression</span>(<span class="st">&#39;log&#39;</span>[<span class="dv">2</span>]<span class="op">*</span><span class="st">&#39;(Fold Change)&#39;</span>), </a>
<a class="sourceLine" id="cb30-4" data-line-number="4">       <span class="dt">y=</span>(<span class="kw">expression</span>(<span class="st">&#39;-log&#39;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&#39;(FDR)&#39;</span>)), </a>
<a class="sourceLine" id="cb30-5" data-line-number="5">       <span class="dt">title=</span><span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Significance), <span class="dt">alpha=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="op">-</span>logFcThreshold, logFcThreshold),</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">             <span class="dt">color=</span><span class="st">&#39;darkgreen&#39;</span>, <span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="op">-</span><span class="kw">log10</span>(adjPvalThreshold), </a>
<a class="sourceLine" id="cb30-10" data-line-number="10">             <span class="dt">color=</span><span class="st">&#39;darkgreen&#39;</span>,<span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="st">  </span><span class="co">#scale_x_continuous(breaks=c(-4,-2,0,2,4,6,8,10)) +</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="st">  </span><span class="co">#scale_y_continuous(expand = c(0.3, 0)) +</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="st">  </span><span class="co">#scale_color_manual(values = c(&#39;#4285F4&#39;,&quot;gray&quot;, &#39;#FBBC05&#39;)) +</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;green3&#39;</span>,<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="st">  </span><span class="co">#facet_wrap(~Comparison, ncol = 2) +</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb30-17" data-line-number="17">                                adj.P.Val <span class="op">&lt;</span><span class="st"> </span>adjPvalThreshold <span class="op">&amp;</span><span class="st"> </span>logFC <span class="op">&gt;</span><span class="st"> </span><span class="kw">log2</span>(<span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb30-18" data-line-number="18">                  <span class="dt">segment.alpha =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">label =</span> Symbol), </a>
<a class="sourceLine" id="cb30-19" data-line-number="19">                  <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">color=</span><span class="st">&#39;red&#39;</span>, <span class="dt">segment.color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(dataForVolcanoPlot, </a>
<a class="sourceLine" id="cb30-21" data-line-number="21">                                adj.P.Val <span class="op">&lt;</span><span class="st"> </span>adjPvalThreshold <span class="op">&amp;</span><span class="st"> </span>logFC <span class="op">&lt;</span><span class="st"> </span><span class="kw">log2</span>(<span class="dv">2</span>)<span class="op">*-</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb30-22" data-line-number="22">                  <span class="dt">segment.alpha =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">label =</span> Symbol), </a>
<a class="sourceLine" id="cb30-23" data-line-number="23">                  <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">color=</span><span class="st">&#39;green3&#39;</span>, <span class="dt">segment.color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb30-26" data-line-number="26">        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb30-27" data-line-number="27">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb30-28" data-line-number="28">        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour=</span><span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb30-29" data-line-number="29">        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb30-31" data-line-number="31">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb30-32" data-line-number="32">        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb30-33" data-line-number="33">        <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>,</a>
<a class="sourceLine" id="cb30-34" data-line-number="34">        <span class="co">#legend.text = element_text(size = 14),</span></a>
<a class="sourceLine" id="cb30-35" data-line-number="35">        <span class="co">#legend.title = element_text(size = 14, face = &#39;bold&#39;),</span></a>
<a class="sourceLine" id="cb30-36" data-line-number="36">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&#39;bold&#39;</span>))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="venn-diagram" class="section level2">
<h2><span class="header-section-number">1.5</span> Venn Diagram</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">library</span>(VennDiagram)</a></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: futile.logger</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">A &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">B &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">600</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">C &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">350</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">D &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">550</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">E &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">375</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">G &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">200</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">H &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">777</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb34-8" data-line-number="8"></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">###### Two sets</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A,<span class="dt">B=</span>B)</a>
<a class="sourceLine" id="cb34-11" data-line-number="11"></a>
<a class="sourceLine" id="cb34-12" data-line-number="12">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>)</a>
<a class="sourceLine" id="cb34-13" data-line-number="13"></a>
<a class="sourceLine" id="cb34-14" data-line-number="14">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_2Sets_Normal.png&#39;</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"></a>
<a class="sourceLine" id="cb34-16" data-line-number="16">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb34-17" data-line-number="17">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb34-18" data-line-number="18">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb34-19" data-line-number="19">                         <span class="dt">col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb34-20" data-line-number="20">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb34-21" data-line-number="21">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb34-22" data-line-number="22">                         <span class="dt">alpha =</span> <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb34-23" data-line-number="23">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb34-24" data-line-number="24">                         <span class="dt">margin =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb34-25" data-line-number="25">                         <span class="dt">cat.dist =</span> <span class="fl">0.03</span>,</a>
<a class="sourceLine" id="cb34-26" data-line-number="26">                         <span class="co">#cat.default.pos = &quot;outer&quot;,</span></a>
<a class="sourceLine" id="cb34-27" data-line-number="27">                         <span class="co">#cat.pos = c(-27, 27, 135),</span></a>
<a class="sourceLine" id="cb34-28" data-line-number="28">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb34-29" data-line-number="29">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb34-30" data-line-number="30">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb34-31" data-line-number="31">                         <span class="dt">cat.cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb34-32" data-line-number="32">                         <span class="dt">cex =</span> <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_2Sets_Normal.png" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">B=</span><span class="dv">71</span><span class="op">:</span><span class="dv">170</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"></a>
<a class="sourceLine" id="cb35-3" data-line-number="3">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_2Sets_Presentation.png&#39;</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"></a>
<a class="sourceLine" id="cb35-6" data-line-number="6">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">                         <span class="dt">col =</span> <span class="st">&#39;white&#39;</span>,</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb35-11" data-line-number="11">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb35-12" data-line-number="12">                         <span class="dt">alpha =</span> <span class="fl">0.6</span>,</a>
<a class="sourceLine" id="cb35-13" data-line-number="13">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb35-14" data-line-number="14">                         <span class="dt">margin =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb35-15" data-line-number="15">                         <span class="dt">cat.dist =</span> <span class="fl">0.03</span>,</a>
<a class="sourceLine" id="cb35-16" data-line-number="16">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb35-17" data-line-number="17">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb35-18" data-line-number="18">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb35-19" data-line-number="19">                         <span class="dt">cat.cex =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb35-20" data-line-number="20">                         <span class="dt">cex =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_2Sets_Presentation.png" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co">### Three Sets</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A, <span class="dt">B=</span>B, <span class="dt">C=</span>C)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"></a>
<a class="sourceLine" id="cb36-4" data-line-number="4">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#EA4335&#39;</span>, <span class="st">&#39;#FBBC05&#39;</span>, <span class="st">&#39;#4285F4&#39;</span>)</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_3Sets.png&#39;</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">                         <span class="dt">col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb36-13" data-line-number="13">                         <span class="dt">alpha =</span> <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb36-15" data-line-number="15">                         <span class="dt">margin =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb36-16" data-line-number="16">                         <span class="dt">cat.dist =</span> <span class="fl">0.03</span>,</a>
<a class="sourceLine" id="cb36-17" data-line-number="17">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb36-18" data-line-number="18">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb36-19" data-line-number="19">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb36-20" data-line-number="20">                         <span class="dt">cat.cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb36-21" data-line-number="21">                         <span class="dt">cex =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_3Sets.png" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co">### Four Sets</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A, <span class="dt">B=</span>B, <span class="dt">C=</span>C, <span class="dt">D=</span>D)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#EA4335&#39;</span>, <span class="st">&#39;#FBBC05&#39;</span>, <span class="st">&#39;#34A853&#39;</span>, <span class="st">&#39;#4285F4&#39;</span>)</a>
<a class="sourceLine" id="cb37-5" data-line-number="5"></a>
<a class="sourceLine" id="cb37-6" data-line-number="6">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_4Sets_Normal.png&#39;</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"></a>
<a class="sourceLine" id="cb37-8" data-line-number="8">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb37-9" data-line-number="9">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb37-10" data-line-number="10">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb37-11" data-line-number="11">                         <span class="dt">col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb37-12" data-line-number="12">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb37-13" data-line-number="13">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb37-14" data-line-number="14">                         <span class="dt">alpha =</span> <span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb37-15" data-line-number="15">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb37-16" data-line-number="16">                         <span class="dt">margin =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb37-17" data-line-number="17">                         <span class="dt">cat.dist =</span> <span class="kw">c</span>(<span class="fl">0.21</span>,<span class="fl">0.21</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb37-18" data-line-number="18">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb37-19" data-line-number="19">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb37-20" data-line-number="20">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb37-21" data-line-number="21">                         <span class="dt">cat.cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb37-22" data-line-number="22">                         <span class="dt">cex =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_4Sets_Normal.png" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_4Sets_Dashed.png&#39;</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">                         <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">                         <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="co"># blank</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">                         <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb38-11" data-line-number="11">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb38-12" data-line-number="12">                         <span class="dt">margin =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">                         <span class="dt">cat.dist =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.4</span>,<span class="op">-</span><span class="fl">0.4</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb38-15" data-line-number="15">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb38-16" data-line-number="16">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb38-17" data-line-number="17">                         <span class="dt">cat.cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb38-18" data-line-number="18">                         <span class="dt">cex =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_4Sets_Dashed.png" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co">### Five Sets</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A, <span class="dt">B=</span>B, <span class="dt">C=</span>C, <span class="dt">D=</span>D, <span class="dt">E=</span>E)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co">#vennDiagramColors &lt;- c(&#39;#EA4335&#39;, &#39;#FBBC05&#39;, &#39;#34A853&#39;, &#39;#4285F4&#39;, &#39;orchid3&#39;)</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>, <span class="st">&quot;seagreen3&quot;</span>, <span class="st">&quot;orchid3&quot;</span>)</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_5Sets.png&#39;</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"></a>
<a class="sourceLine" id="cb39-8" data-line-number="8">vennPlot &lt;-<span class="st"> </span><span class="kw">venn.diagram</span>(dataForVennDiagram,</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">                         <span class="dt">filename =</span> vennFilename,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">                         <span class="dt">imagetype =</span> <span class="st">&#39;png&#39;</span>,</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">                         <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb39-12" data-line-number="12">                         <span class="dt">fill =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb39-13" data-line-number="13">                         <span class="dt">lwd =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb39-14" data-line-number="14">                         <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb39-15" data-line-number="15">                         <span class="co">#lty = &quot;dashed&quot;,</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16">                         <span class="dt">fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb39-17" data-line-number="17">                         <span class="dt">margin =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb39-18" data-line-number="18">                         <span class="co">#cat.dist = c(0.21,0.21,0.1,0.1),</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19">                         <span class="dt">cat.col =</span> vennDiagramColors,</a>
<a class="sourceLine" id="cb39-20" data-line-number="20">                         <span class="dt">cat.fontface =</span> <span class="st">&#39;bold&#39;</span>,</a>
<a class="sourceLine" id="cb39-21" data-line-number="21">                         <span class="dt">cat.fontfamily =</span> <span class="st">&#39;sans&#39;</span>,</a>
<a class="sourceLine" id="cb39-22" data-line-number="22">                         <span class="dt">cat.cex =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb39-23" data-line-number="23">                         <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb39-24" data-line-number="24">                                 <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb39-25" data-line-number="25">                                 <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb39-26" data-line-number="26">                                 <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">1.5</span>))</a></code></pre></div>
<p><img src="report/venn/Venn_Diagram_5Sets.png" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">library</span>(Vennerable)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">vennData &lt;-<span class="st"> </span><span class="kw">Venn</span>(dataForVennDiagram)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">vennData</a></code></pre></div>
<pre><code>## A Venn object on 5 sets named
## A,B,C,D,E 
## 00000 10000 01000 11000 00100 10100 01100 11100 00010 10010 01010 11010 
##     0    29    72    36    28    17    35    25    42    43    75    58 
## 00110 10110 01110 11110 00001 10001 01001 11001 00101 10101 01101 11101 
##    27    22    47    30    33    18    45    22     9     6    20    16 
## 00011 10011 01011 11011 00111 10111 01111 11111 
##    41    22    49    26    10    14    28    16</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">genesInAll &lt;-<span class="st"> </span>vennData<span class="op">@</span>IntersectionSets[[<span class="st">&#39;11111&#39;</span>]]</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">genesInAll</a></code></pre></div>
<pre><code>##  [1] 983 639 202 947 229 504 563 622 659 620 732 378  31  69 786 675</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co">### Six Sets</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="kw">library</span>(venn)</a>
<a class="sourceLine" id="cb44-3" data-line-number="3"></a>
<a class="sourceLine" id="cb44-4" data-line-number="4">dataForVennDiagram &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A, <span class="dt">B=</span>B, <span class="dt">C=</span>C, <span class="dt">D=</span>D, <span class="dt">E=</span>E, <span class="dt">G=</span>G)</a>
<a class="sourceLine" id="cb44-5" data-line-number="5"></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="co">#vennDiagramColors &lt;- c(&#39;#EA4335&#39;, &#39;#FBBC05&#39;, &#39;#34A853&#39;, &#39;#4285F4&#39;, &#39;orchid3&#39;)</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">vennDiagramColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>, <span class="st">&quot;seagreen3&quot;</span>, <span class="st">&quot;orchid3&quot;</span>, <span class="st">&#39;cyan&#39;</span>) <span class="co"># </span><span class="al">TODO</span><span class="co">: cyan is not good enough</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8">vennFilename &lt;-<span class="st"> &#39;report/Venn_Diagram_6Sets.png&#39;</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9"></a>
<a class="sourceLine" id="cb44-10" data-line-number="10"><span class="kw">venn</span>(dataForVennDiagram, <span class="dt">zcolor =</span> <span class="st">&quot;style&quot;</span>, <span class="dt">opacity =</span> <span class="fl">0.25</span>, <span class="dt">cexil =</span> <span class="fl">0.5</span>, <span class="dt">cexsn =</span> <span class="fl">0.5</span>, <span class="dt">ellipse =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="upset-plot" class="section level2">
<h2><span class="header-section-number">1.6</span> UpSet plot</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co">#devtools::install_github(&quot;hms-dbmi/UpSetR&quot;)</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">library</span>(UpSetR)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"></a>
<a class="sourceLine" id="cb45-4" data-line-number="4">A &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">B &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">600</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-6" data-line-number="6">C &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">350</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">D &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">550</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-8" data-line-number="8">E &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">375</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-9" data-line-number="9">G &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">200</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-10" data-line-number="10">H &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">777</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb45-11" data-line-number="11"></a>
<a class="sourceLine" id="cb45-12" data-line-number="12">dataForUpSetPlot &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A=</span>A, <span class="dt">B=</span>B, <span class="dt">C=</span>C, <span class="dt">D=</span>D, <span class="dt">E=</span>E, <span class="dt">G=</span>G, <span class="dt">H=</span>H)</a>
<a class="sourceLine" id="cb45-13" data-line-number="13">setsBarColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#EA4335&#39;</span>, <span class="st">&#39;#FBBC05&#39;</span>, <span class="st">&#39;#34A853&#39;</span>, <span class="st">&#39;#4285F4&#39;</span>)</a>
<a class="sourceLine" id="cb45-14" data-line-number="14"></a>
<a class="sourceLine" id="cb45-15" data-line-number="15"><span class="co">### sort by degree</span></a>
<a class="sourceLine" id="cb45-16" data-line-number="16"><span class="kw">upset</span>(<span class="kw">fromList</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb45-17" data-line-number="17">      <span class="dt">nsets=</span><span class="kw">length</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb45-18" data-line-number="18">      <span class="dt">nintersects =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb45-19" data-line-number="19">      <span class="dt">sets =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&#39;D&#39;</span>),</a>
<a class="sourceLine" id="cb45-20" data-line-number="20">      <span class="co">#keep.order = TRUE,</span></a>
<a class="sourceLine" id="cb45-21" data-line-number="21">      <span class="dt">point.size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb45-22" data-line-number="22">      <span class="dt">line.size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb45-23" data-line-number="23">      <span class="dt">number.angles =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb45-24" data-line-number="24">      <span class="dt">text.scale =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="co"># ytitle, ylabel, xtitle, xlabel, sets, number</span></a>
<a class="sourceLine" id="cb45-25" data-line-number="25">      <span class="dt">order.by=</span><span class="st">&quot;degree&quot;</span>,</a>
<a class="sourceLine" id="cb45-26" data-line-number="26">      <span class="dt">matrix.color=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb45-27" data-line-number="27">      <span class="dt">main.bar.color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb45-28" data-line-number="28">      <span class="dt">mainbar.y.label =</span> <span class="st">&#39;Intersection Size&#39;</span>,</a>
<a class="sourceLine" id="cb45-29" data-line-number="29">      <span class="dt">sets.bar.color=</span>setsBarColors,</a>
<a class="sourceLine" id="cb45-30" data-line-number="30">      <span class="dt">queries =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">query =</span> intersects,</a>
<a class="sourceLine" id="cb45-31" data-line-number="31">           <span class="dt">params =</span> <span class="kw">list</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>), <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">active =</span> T)))</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co">### sort by frequency of intersection</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">upset</span>(<span class="kw">fromList</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">      <span class="dt">nsets=</span><span class="kw">length</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">      <span class="dt">nintersects =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">      <span class="dt">sets =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&#39;D&#39;</span>),</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">      <span class="co">#keep.order = TRUE,</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7">      <span class="dt">point.size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">      <span class="dt">line.size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">      <span class="dt">number.angles =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb46-10" data-line-number="10">      <span class="dt">text.scale =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="co"># ytitle, ylabel, xtitle, xlabel, sets, number</span></a>
<a class="sourceLine" id="cb46-11" data-line-number="11">      <span class="dt">order.by=</span><span class="st">&quot;freq&quot;</span>,</a>
<a class="sourceLine" id="cb46-12" data-line-number="12">      <span class="dt">matrix.color=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb46-13" data-line-number="13">      <span class="dt">main.bar.color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb46-14" data-line-number="14">      <span class="dt">mainbar.y.label =</span> <span class="st">&#39;Intersection Size&#39;</span>,</a>
<a class="sourceLine" id="cb46-15" data-line-number="15">      <span class="dt">sets.bar.color=</span>setsBarColors)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co">### sort by degree, then frequency, keep order</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="kw">upset</span>(<span class="kw">fromList</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">      <span class="dt">nsets=</span><span class="kw">length</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">      <span class="dt">nintersects =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">      <span class="dt">sets =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&#39;D&#39;</span>),</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">      <span class="dt">keep.order =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">      <span class="dt">point.size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb47-8" data-line-number="8">      <span class="dt">line.size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb47-9" data-line-number="9">      <span class="dt">number.angles =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb47-10" data-line-number="10">      <span class="dt">text.scale =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="co"># ytitle, ylabel, xtitle, xlabel, sets, number</span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11">      <span class="co">#order.by=&quot;degree&quot;,</span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12">      <span class="dt">matrix.color=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb47-13" data-line-number="13">      <span class="dt">main.bar.color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb47-14" data-line-number="14">      <span class="dt">mainbar.y.label =</span> <span class="st">&#39;Intersection Size&#39;</span>,</a>
<a class="sourceLine" id="cb47-15" data-line-number="15">      <span class="dt">sets.bar.color=</span>setsBarColors)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-22-3.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="co">### all sets</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">setsBarColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>, <span class="st">&quot;seagreen3&quot;</span>, <span class="st">&quot;orchid3&quot;</span>, <span class="st">&#39;cyan3&#39;</span>, <span class="st">&#39;brown2&#39;</span>)</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="kw">upset</span>(<span class="kw">fromList</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">      <span class="dt">nsets=</span><span class="kw">length</span>(dataForUpSetPlot),</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">      <span class="dt">nintersects =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb48-7" data-line-number="7">      <span class="co">#sets = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &#39;D&#39;,&#39;E&#39;,&#39;G&#39;,&#39;H&#39;),</span></a>
<a class="sourceLine" id="cb48-8" data-line-number="8">      <span class="co">#keep.order = TRUE,</span></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">      <span class="dt">point.size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">      <span class="dt">line.size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb48-11" data-line-number="11">      <span class="dt">number.angles =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb48-12" data-line-number="12">      <span class="dt">text.scale =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="co"># ytitle, ylabel, xtitle, xlabel, sets, number</span></a>
<a class="sourceLine" id="cb48-13" data-line-number="13">      <span class="co">#order.by=&quot;degree&quot;,</span></a>
<a class="sourceLine" id="cb48-14" data-line-number="14">      <span class="dt">matrix.color=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb48-15" data-line-number="15">      <span class="dt">main.bar.color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb48-16" data-line-number="16">      <span class="dt">mainbar.y.label =</span> <span class="st">&#39;Intersection Size&#39;</span>,</a>
<a class="sourceLine" id="cb48-17" data-line-number="17">      <span class="dt">sets.bar.color=</span>setsBarColors)</a></code></pre></div>
<p><img src="BioinfoHub_files/figure-html/unnamed-chunk-22-4.png" width="672" /></p>
</div>
<div id="heatmap" class="section level2">
<h2><span class="header-section-number">1.7</span> Heatmap</h2>
</div>
<div id="bubble-plot" class="section level2">
<h2><span class="header-section-number">1.8</span> Bubble plot</h2>
</div>
<div id="radar-plot" class="section level2">
<h2><span class="header-section-number">1.9</span> Radar plot</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="GEO.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-Visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["BioinfoHub.pdf", "BioinfoHub.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
